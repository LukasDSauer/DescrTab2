---
title: "Test with labels"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(DescrTab2)
library(tidyverse)

```

```{r, include = FALSE}
source("C:/Users/janme/Downloads/PRiVENT20210429_R_2021-06-14_0940.r", encoding = "UTF-8")
data <- as_tibble(data)
colnames_data <- names(data)
for (colname in colnames_data){
  if (str_detect(colname, "\\.factor$")){
    fac <- data[[colname]]
    label(fac) <- label(data[[str_remove(colname, "\\.factor$")]])
    data[str_remove(colname, "\\.factor$")] <- fac
    data <- data[names(data)!= colname]
  }
}
unlabel <- function(x){
  class(x) <- class(x)[class(x)!="labelled"]
  attr(x, "label") <- NULL
  x
}
data_nolab <- data %>% 
  transmute(across(everything(), unlabel))
```

```{r, warning=FALSE, message=FALSE}
descr(data, format_options=list(combine_mean_sd = TRUE, combine_median_Q1_Q3 = TRUE,
                      categorical_missing_percent_mode  = "missing_as_separate_category"))
```
